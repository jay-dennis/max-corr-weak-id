Matlab Code for Dennis (2019) ``Testing White Noise When Some Parameters may be Weakly Identified.''

The zip file contains the following .m files:

- class_innovations.m
- class_dgp.m
- class_tests.m
- data_0_combine_files.m
- data_1_1_post_process.m
- data_1_post_process_loop.m
- data_2_make_include_file.m
- make_cluster_submission_folder_batch.m
- simulate.m
- tabletotex.m


The file make_cluster_submission_folder_batch.m is the main file for submitting simulation jobs on UNC's LongLeaf cluster.  
This file creates a cluster submission directory and copies simulate and the class_ files into the cluster submission directory.  It also creates .txt files for each of the T=# cases.  These .txt files contain the SLURM commands for batch job submission to the LongLeaf cluster at UNC.  To run the batches on LongLeaf, copy the contents of the directory into your LongLeaf working directory, change to this directory, copy the contents of the .txt file (e.g. ll_T100.txt) and paste them to the command line.


The file simulate.m instantiates a vector of class_tests objects using the 
parameters given.  It then esimates the parameters of the model for each 
object and runs the tests outlined in Dennis (2019).  The parameters are as follows:

dgp = 1 : STAR(1)
    = 2 : misspecified STAR(2)
    = 3 : ARMA(1,1)
    
id  = 0 : Identification failure
    = 1 : Weak identification
    = 2 : Strong identification

e = 1,2,3,4,5,6,7,8,9 corresponding to the respective innovation outlined in Dennis and Hill (2017)

f = 0 : Infeasible tests (nuisance parameters are known)
  = 1 : Feasible tests (take sup over a grid of nuisance parameters).  Note: this option is 
        very computationally intensive, so be aware if you are running simulations rather
        than using this on data.
J = 1   the number of random sample paths (testing object instantiations) that you wish to run.
                
T = 100, 250, 500, 1000 corresponding to the length of each random path

Therefore, running 'simulate(1,1,1,0,1,100)' generates and estimates 
a single random path of length T=100 of the STAR(1) model under weak identification with 
iid errors and produces tests, critical values, and decision rules assuming that the nuisance
parameters are known.
    

The class_ files define and allow instantiation of the simulations.  class_tests inherits
from class_dgp which inherits from class_innovations.  class_innovations contains all code
relevant to the innovations, class_dgp contains all code relevant to the 3 dgps including 
parameter estimation and dgp specific objects used in the calculation of the correlation 
expansions outlined in Dennis and Hill (2017).  class_tests contains all code relevant to 
the testing procedures including the correlation expansion calculations and the dependent
wild bootstrap.


The files named data_ are for post processing.  Run them in order (0,1,2).  
data_0 combines the batch output for each groups into a single file.
data_1..._loop loops over the combined files and generates latex tables for the rejection
frequencies. You do not need to run data_1_1 as this is used internally by data_1..._loop.
data_2 generates a latex file that includes all of the tables generated by data_1.
tabletotex.m is the data to latex table conversion program.


    
    
    
    
    
    
    
    
    
    
    
